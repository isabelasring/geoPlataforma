<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyectos Industria - GeoPlataforma</title>
    <script>(function(){var t=localStorage.getItem('geoPlataforma-theme');if(t==='dark')document.documentElement.setAttribute('data-theme','dark');})();</script>
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/ciudades-proyectos.css">
    <style>
        /* Imagen de fondo específica para proyectos industria: 360 PepsiCo con blur */
        .proyectos-hero-bg {
            background-image: url('../proyectos/360_PEPSICO_60.jpg');
            background-size: cover;
            background-position: center;
            filter: blur(10px);
            -webkit-filter: blur(10px);
            transform: scale(1.08);
        }
    </style>
</head>
<body>

    <nav class="navbar scrolled" id="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <img src="../img%3Avideo/isologo-01.png" alt="GeoPlataforma" class="logo-img">
            </a>
            <ul class="nav-links">
                <li><a href="index.html">Inicio</a></li>
                <li class="nav-dropdown nav-dropdown-servicios">
                    <button type="button" class="nav-dropdown-toggle" aria-expanded="false" aria-haspopup="true">Servicios</button>
                    <ul class="nav-dropdown-menu nav-dropdown-menu-servicios">
                        <li class="nav-dropdown-item-with-panel">
                            <a href="ciudades.html">Ciudades</a>
                            <div class="nav-services-panel nav-panel-ciudades" aria-hidden="true">
                                <span class="nav-panel-label">Servicios en Ciudades</span>
                                <a href="ciudades.html">IoT</a>
                                <a href="ciudades.html">Mapas de ruido</a>
                                <a href="ciudades.html">Ecosistemas WEBGIS</a>
                                <a href="ciudades.html">Planes de descontaminación acústica</a>
                                <a href="ciudades.html">Analítica geoespacial</a>
                            </div>
                        </li>
                        <li class="nav-dropdown-item-with-panel">
                            <a href="industria.html">Industria</a>
                            <div class="nav-services-panel nav-panel-industria" aria-hidden="true">
                                <span class="nav-panel-label">Servicios en Industria</span>
                                <a href="industria.html">IoT</a>
                                <a href="industria.html">Control de ruido</a>
                                <a href="industria.html">Clasificación de fuentes</a>
                                <a href="industria.html">Modelación de ruido</a>
                                <a href="industria.html">Holografía acústica</a>
                                <a href="industria.html">Medición de vibraciones</a>
                                <a href="industria.html">Modelación de vibraciones</a>
                                <a href="industria.html">Modelación de ruido subacuático</a>
                                <a href="industria.html">Medición de ruido subacuático</a>
                                <a href="industria.html">Analítica geoespacial</a>
                                <a href="industria.html">Fotogrametría</a>
                            </div>
                        </li>
                        <li><a href="#">Infraestructura</a></li>
                    </ul>
                </li>
                <li class="nav-dropdown">
                    <button type="button" class="nav-dropdown-toggle" aria-expanded="false" aria-haspopup="true">Proyectos</button>
                    <ul class="nav-dropdown-menu">
                        <li><a href="ciudades-proyectos.html">Ciudades</a></li>
                        <li><a href="industria-proyectos.html">Industria</a></li>
                        <li><a href="#">Infraestructura</a></li>
                    </ul>
                </li>
                <li><a href="about.html">Nosotros</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="contacto.html">Contacto</a></li>
            </ul>
            <div class="nav-theme-wrap">
                <button type="button" class="nav-theme-btn" id="theme-toggle" aria-label="Usar modo oscuro" title="Modo oscuro">
                    <span class="nav-theme-icon nav-theme-icon-sun" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg></span>
                    <span class="nav-theme-icon nav-theme-icon-moon" aria-hidden="true" hidden><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span>
                </button>
            </div>
        </div>
    </nav>

    <main class="proyectos-page">
        <div class="proyectos-hero-bg" aria-hidden="true"></div>
        <div class="proyectos-hero-overlay" aria-hidden="true"></div>
        
        <div class="proyectos-filters-container">
            <div class="proyectos-tags-top" role="tablist">
                <button type="button" class="proyectos-tag active" data-servicio="iot" role="tab">IoT</button>
                <button type="button" class="proyectos-tag" data-servicio="control-ruido" role="tab">Control de ruido</button>
                <button type="button" class="proyectos-tag" data-servicio="clasificacion-fuentes" role="tab">Clasificación de fuentes</button>
                <button type="button" class="proyectos-tag" data-servicio="modelacion-ruido" role="tab">Modelación de ruido</button>
                <button type="button" class="proyectos-tag" data-servicio="holografia-acustica" role="tab">Holografía acústica</button>
                <button type="button" class="proyectos-tag" data-servicio="medicion-vibraciones" role="tab">Medición de vibraciones</button>
                <button type="button" class="proyectos-tag" data-servicio="modelacion-vibraciones" role="tab">Modelación de vibraciones</button>
                <button type="button" class="proyectos-tag" data-servicio="modelacion-ruido-subacuatico" role="tab">Modelación ruido subacuático</button>
                <button type="button" class="proyectos-tag" data-servicio="medicion-ruido-subacuatico" role="tab">Medición ruido subacuático</button>
                <button type="button" class="proyectos-tag" data-servicio="geoespacial" role="tab">Analítica geoespacial</button>
                <button type="button" class="proyectos-tag" data-servicio="fotogrametria" role="tab">Fotogrametría</button>
            </div>
            <div class="proyectos-search-bar">
                <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
                <input type="search" class="search-input" placeholder="Buscar proyectos..." aria-label="Buscar proyectos">
            </div>
        </div>
        
        <div class="proyectos-content">
            <div class="proyectos-left">
                <a href="industria.html" class="proyectos-back" aria-label="Volver a Industria">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M14 12H8"/><path d="M10 8l-2 4 2 4"/></svg>
                </a>
                <div class="proyectos-title-section">
                    <span class="proyectos-location">Colombia</span>
                    <h1 class="proyectos-title">INDUSTRIA</h1>
                    <p class="proyectos-description">Transformación digital y optimización de procesos industriales. Soluciones geoespaciales para la industria sostenible y eficiente.</p>
                </div>
            </div>

            <div class="proyectos-right">
                <div class="proyectos-cards-container">
                    <button type="button" class="carousel-btn carousel-prev" aria-label="Anterior">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
                    </button>
                    <div class="proyectos-carousel">
                        <p class="proyectos-empty-message" id="proyectos-empty-message" style="display: none;" aria-live="polite">No hay proyectos disponibles</p>
                        <div class="carousel-track" id="industria-carousel-track">
                            <article class="proyecto-card proyecto-card-refineria" data-servicio="control-ruido" data-proyecto="refineria-cartagena" style="display: none;"
                                data-proyecto-titulo="Refinería Cartagena" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="Refinería de Cartagena"
                                data-proyecto-desc="Control de ruido y gestión ambiental industrial">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle Refinería Cartagena">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/refineriaCartagena/KIMG0855.JPG');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">Refinería Cartagena</h3>
                                        <p class="proyecto-card-desc">Control de ruido y gestión ambiental industrial</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-viva-magdalena" data-servicio="control-ruido" data-proyecto="viva-magdalena" style="display: none;"
                                data-proyecto-titulo="Viva Magdalena" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="Viva Magdalena"
                                data-proyecto-desc="Análisis acústico y control de ruido industrial">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle Viva Magdalena">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/vivaMagdalena/IMG_6897.jpeg');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">Viva Magdalena</h3>
                                        <p class="proyecto-card-desc">Análisis acústico y control de ruido industrial</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-arclad" data-servicios="control-ruido clasificacion-fuentes modelacion-ruido fotogrametria" data-proyecto="arclad" style="display: none;"
                                data-proyecto-titulo="ARCLAD" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="ARCLAD"
                                data-proyecto-desc="Control de ruido, clasificación de fuentes y modelación acústica industrial">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle ARCLAD">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/ARCLAD/GTR00661.JPG');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">ARCLAD</h3>
                                        <p class="proyecto-card-desc">Control de ruido, clasificación de fuentes y modelación acústica industrial</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-segovia" data-servicio="medicion-vibraciones" data-proyecto="segovia" style="display: none;"
                                data-proyecto-titulo="Segovia" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="Segovia"
                                data-proyecto-desc="Medición de vibraciones y monitoreo industrial">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle Segovia">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/segovia/20200919_115240.jpg');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">Segovia</h3>
                                        <p class="proyecto-card-desc">Medición de vibraciones y monitoreo industrial</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-ccr-palagua" data-servicio="fotogrametria" data-proyecto="ccr-palagua" style="display: none;"
                                data-proyecto-titulo="CCR Palagua" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="CCR Palagua"
                                data-proyecto-desc="Fotogrametría y levantamiento geoespacial industrial">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle CCR Palagua">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/ccrPalagua/PRMGS_PALOMINO_00008.jpg');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">CCR Palagua</h3>
                                        <p class="proyecto-card-desc">Fotogrametría y levantamiento geoespacial industrial</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-colcafe" data-servicios="control-ruido holografia-acustica medicion-vibraciones" data-proyecto="colcafe" style="display: none;"
                                data-proyecto-titulo="Colcafé" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="Colcafé"
                                data-proyecto-desc="Control de ruido, holografía acústica y medición de vibraciones">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle Colcafé">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/colcafe/WhatsApp%20Image%202024-12-23%20at%2011.03.16%20AM%20%281%29.jpeg');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">Colcafé</h3>
                                        <p class="proyecto-card-desc">Control de ruido, holografía acústica y medición de vibraciones</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-cerrejon" data-servicios="holografia-acustica" data-proyecto="cerrejon" style="display: none;"
                                data-proyecto-titulo="Cerrejón" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="Cerrejón"
                                data-proyecto-desc="Holografía acústica y diagnóstico de fuentes de ruido industrial">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle Cerrejón">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/cerrejon/IMG_7326.jpeg');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">Cerrejón</h3>
                                        <p class="proyecto-card-desc">Holografía acústica y diagnóstico de fuentes de ruido industrial</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-mineros-bic" data-servicios="holografia-acustica" data-proyecto="mineros-bic" style="display: none;"
                                data-proyecto-titulo="Mineros BIC" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="Mineros BIC"
                                data-proyecto-desc="Holografía acústica y diagnóstico de fuentes de ruido industrial">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle Mineros BIC">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/minerosBic/IMG_3163.JPG');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">Mineros BIC</h3>
                                        <p class="proyecto-card-desc">Holografía acústica y diagnóstico de fuentes de ruido industrial</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-pepsico" data-servicios="control-ruido clasificacion-fuentes modelacion-ruido fotogrametria" data-proyecto="pepsico" style="display: none;"
                                data-proyecto-titulo="PepsiCo" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="PepsiCo"
                                data-proyecto-desc="Control de ruido, clasificación de fuentes, modelación de ruido y fotogrametría">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle PepsiCo">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/pepsico/IMG_6783.jpeg');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">PepsiCo</h3>
                                        <p class="proyecto-card-desc">Control de ruido, clasificación de fuentes, modelación de ruido y fotogrametría</p>
                                    </div>
                                </div>
                            </article>
                            <article class="proyecto-card proyecto-card-spia" data-servicios="modelacion-ruido-subacuatico medicion-ruido-subacuatico" data-proyecto="spia" style="display: none;"
                                data-proyecto-titulo="SPIA" data-proyecto-categoria="industria" data-proyecto-ano="2024" data-proyecto-cliente="SPIA"
                                data-proyecto-desc="Medición y modelación de ruido subacuático">
                                <div class="proyecto-card-link-wrap" role="button" tabindex="0" aria-label="Ver detalle SPIA">
                                    <div class="proyecto-card-img" style="background-image: url('../proyectos/industria/spia/IMG_3413.jpeg');"></div>
                                    <div class="proyecto-card-content">
                                        <h3 class="proyecto-card-title">SPIA</h3>
                                        <p class="proyecto-card-desc">Medición y modelación de ruido subacuático</p>
                                    </div>
                                </div>
                            </article>
                        </div>
                    </div>
                    <button type="button" class="carousel-btn carousel-next" aria-label="Siguiente">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Panel de detalle: se despliega desde la derecha; izquierda = carrusel de imágenes del proyecto -->
        <div class="proyecto-panel" id="proyecto-panel" aria-hidden="true">
            <div class="proyecto-panel-inner">
                <button type="button" class="proyecto-panel-close" id="proyecto-panel-close" aria-label="Cerrar panel">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
                </button>
                <div class="proyecto-panel-image-wrap">
                    <div class="proyecto-panel-carousel-wrap">
                        <button type="button" class="proyecto-panel-carousel-prev" id="proyecto-panel-carousel-prev" aria-label="Imagen anterior">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
                        </button>
                        <div class="proyecto-panel-carousel-track" id="proyecto-panel-carousel-track">
                            <!-- Imágenes del proyecto se inyectan por JS -->
                        </div>
                        <button type="button" class="proyecto-panel-carousel-next" id="proyecto-panel-carousel-next" aria-label="Siguiente imagen">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
                        </button>
                    </div>
                </div>
                <div class="proyecto-panel-content">
                    <h2 id="proyecto-panel-title" class="proyecto-panel-title"></h2>
                    <div class="proyecto-panel-meta">
                        <p class="proyecto-panel-meta-item">Categoría: <span id="proyecto-panel-categoria"></span></p>
                        <p class="proyecto-panel-meta-item">Año: <span id="proyecto-panel-ano"></span></p>
                        <p class="proyecto-panel-meta-item">Cliente: <span id="proyecto-panel-cliente"></span></p>
                    </div>
                    <p class="proyecto-panel-label">Descripción del proyecto</p>
                    <p id="proyecto-panel-desc" class="proyecto-panel-desc"></p>
                </div>
            </div>
        </div>
        <div class="proyecto-panel-backdrop" id="proyecto-panel-backdrop" aria-hidden="true"></div>
    </main>

    <script src="data/refineria-cartagena-images.js"></script>
    <script src="data/viva-magdalena-images.js"></script>
    <script src="data/arclad-images.js"></script>
    <script src="data/segovia-images.js"></script>
    <script src="data/ccr-palagua-images.js"></script>
    <script src="data/colcafe-images.js"></script>
    <script src="data/cerrejon-images.js"></script>
    <script src="data/mineros-bic-images.js"></script>
    <script src="data/pepsico-images.js"></script>
    <script src="data/spia-images.js"></script>
    <script>
        (function() {
            // Proyectos: tags se deslizan y texto izquierda aparece al entrar en vista
            var page = document.querySelector('.proyectos-page');
            if (page) {
                var animated = false;
                var observer = new IntersectionObserver(function(entries) {
                    entries.forEach(function(entry) {
                        if (entry.isIntersecting && !animated) {
                            animated = true;
                            page.classList.add('proyectos-animated');
                        }
                    });
                }, { rootMargin: '0px', threshold: 0.1 });
                observer.observe(page);
            }

            var params = new URLSearchParams(window.location.search);
            var servicio = params.get('servicio') || 'iot';
            var tagMap = {
                iot: 0, 'control-ruido': 1, 'clasificacion-fuentes': 2, 'modelacion-ruido': 3,
                'holografia-acustica': 4, 'medicion-vibraciones': 5, 'modelacion-vibraciones': 6,
                'modelacion-ruido-subacuatico': 7, 'medicion-ruido-subacuatico': 8,
                geoespacial: 9, fotogrametria: 10
            };
            var tags = document.querySelectorAll('.proyectos-tag');
            var idx = tagMap[servicio] !== undefined ? tagMap[servicio] : 0;
            tags.forEach(function(t, i) { t.classList.toggle('active', i === idx); });

            function toggleIndustryCards() {
                var activeTag = document.querySelector('.proyectos-tag.active');
                var s = activeTag ? (activeTag.getAttribute('data-servicio') || '').trim() : '';
                var isControlRuido = s === 'control-ruido';
                var isClasificacionFuentes = s === 'clasificacion-fuentes';
                var isModelacionRuido = s === 'modelacion-ruido';
                var isFotogrametria = s === 'fotogrametria';
                var isMedicionVibraciones = s === 'medicion-vibraciones';
                var isHolografiaAcustica = s === 'holografia-acustica';
                var isModelacionRuidoSubacuatico = s === 'modelacion-ruido-subacuatico';
                var isMedicionRuidoSubacuatico = s === 'medicion-ruido-subacuatico';
                var showArclad = isControlRuido || isClasificacionFuentes || isModelacionRuido || isFotogrametria;
                var showPepsico = isControlRuido || isClasificacionFuentes || isModelacionRuido || isFotogrametria;
                var showSpia = isModelacionRuidoSubacuatico || isMedicionRuidoSubacuatico;
                var showColcafe = isControlRuido || isHolografiaAcustica || isMedicionVibraciones;
                var refineria = document.querySelector('.proyecto-card-refineria');
                var vivaMagdalena = document.querySelector('.proyecto-card-viva-magdalena');
                var arclad = document.querySelector('.proyecto-card-arclad');
                var segovia = document.querySelector('.proyecto-card-segovia');
                var ccrPalagua = document.querySelector('.proyecto-card-ccr-palagua');
                var colcafe = document.querySelector('.proyecto-card-colcafe');
                var cerrejon = document.querySelector('.proyecto-card-cerrejon');
                var minerosBic = document.querySelector('.proyecto-card-mineros-bic');
                var pepsico = document.querySelector('.proyecto-card-pepsico');
                var spia = document.querySelector('.proyecto-card-spia');
                var emptyMsg = document.getElementById('proyectos-empty-message');
                var carouselTrack = document.getElementById('industria-carousel-track');
                var hasAnyProject = isControlRuido || showArclad || isMedicionVibraciones || isFotogrametria || showColcafe || isHolografiaAcustica || showPepsico || showSpia;
                if (refineria) refineria.style.display = isControlRuido ? 'block' : 'none';
                if (vivaMagdalena) vivaMagdalena.style.display = isControlRuido ? 'block' : 'none';
                if (arclad) arclad.style.display = showArclad ? 'block' : 'none';
                if (segovia) segovia.style.display = isMedicionVibraciones ? 'block' : 'none';
                if (ccrPalagua) ccrPalagua.style.display = isFotogrametria ? 'block' : 'none';
                if (colcafe) colcafe.style.display = showColcafe ? 'block' : 'none';
                if (cerrejon) cerrejon.style.display = isHolografiaAcustica ? 'block' : 'none';
                if (minerosBic) minerosBic.style.display = isHolografiaAcustica ? 'block' : 'none';
                if (pepsico) pepsico.style.display = showPepsico ? 'block' : 'none';
                if (spia) spia.style.display = showSpia ? 'block' : 'none';
                if (emptyMsg) emptyMsg.style.display = hasAnyProject ? 'none' : 'flex';
                if (carouselTrack) carouselTrack.style.display = hasAnyProject ? 'flex' : 'none';
            }
            toggleIndustryCards();

            tags.forEach(function(btn) {
                btn.addEventListener('click', function() {
                    tags.forEach(function(t) { t.classList.remove('active'); });
                    btn.classList.add('active');
                    var s = btn.getAttribute('data-servicio');
                    var url = new URL(window.location.href);
                    url.searchParams.set('servicio', s);
                    window.history.replaceState({}, '', url);
                    toggleIndustryCards();
                });
            });

            var track = document.querySelector('.carousel-track');
            var prev = document.querySelector('.carousel-prev');
            var next = document.querySelector('.carousel-next');
            var cardWidth = 320; // Ancho fijo de las cards
            var gap = 20; // Gap entre cards

            function go(delta) {
                if (!track) return;
                var scrollAmount = (cardWidth + gap) * delta;
                track.scrollBy({ left: scrollAmount, behavior: 'smooth' });
            }

            if (prev) prev.addEventListener('click', function() { go(-1); });
            if (next) next.addEventListener('click', function() { go(1); });

            /* Panel de detalle: abrir al hacer clic en una card; izquierda = carrusel de imágenes del proyecto */
            var page = document.querySelector('.proyectos-page');
            var panel = document.getElementById('proyecto-panel');
            var backdrop = document.getElementById('proyecto-panel-backdrop');
            var closeBtn = document.getElementById('proyecto-panel-close');
            var panelCarouselTrack = document.getElementById('proyecto-panel-carousel-track');
            var panelCarouselPrev = document.getElementById('proyecto-panel-carousel-prev');
            var panelCarouselNext = document.getElementById('proyecto-panel-carousel-next');
            var panelTitle = document.getElementById('proyecto-panel-title');
            var panelCategoria = document.getElementById('proyecto-panel-categoria');
            var panelAno = document.getElementById('proyecto-panel-ano');
            var panelCliente = document.getElementById('proyecto-panel-cliente');
            var panelDesc = document.getElementById('proyecto-panel-desc');

            var panelCarouselIndex = 0;
            var panelCarouselImages = [];

            function getIndustryImagesAndBase(proyectoId) {
                var images = [];
                var base = '';
                if (proyectoId === 'refineria-cartagena' && typeof REFINERIA_CARTAGENA_IMAGES !== 'undefined' && REFINERIA_CARTAGENA_IMAGES.length) {
                    images = REFINERIA_CARTAGENA_IMAGES;
                    base = '../proyectos/industria/refineriaCartagena/';
                } else if (proyectoId === 'viva-magdalena' && typeof VIVA_MAGDALENA_IMAGES !== 'undefined' && VIVA_MAGDALENA_IMAGES.length) {
                    images = VIVA_MAGDALENA_IMAGES;
                    base = '../proyectos/industria/vivaMagdalena/';
                } else if (proyectoId === 'arclad' && typeof ARCLAD_IMAGES !== 'undefined' && ARCLAD_IMAGES.length) {
                    images = ARCLAD_IMAGES;
                    base = '../proyectos/industria/ARCLAD/';
                } else if (proyectoId === 'segovia' && typeof SEGOVIA_IMAGES !== 'undefined' && SEGOVIA_IMAGES.length) {
                    images = SEGOVIA_IMAGES;
                    base = '../proyectos/industria/segovia/';
                } else if (proyectoId === 'ccr-palagua' && typeof CCR_PALAGUA_IMAGES !== 'undefined' && CCR_PALAGUA_IMAGES.length) {
                    images = CCR_PALAGUA_IMAGES;
                    base = '../proyectos/industria/ccrPalagua/';
                } else if (proyectoId === 'colcafe' && typeof COLCAFE_IMAGES !== 'undefined' && COLCAFE_IMAGES.length) {
                    images = COLCAFE_IMAGES;
                    base = '../proyectos/industria/colcafe/';
                } else if (proyectoId === 'cerrejon' && typeof CERREJON_IMAGES !== 'undefined' && CERREJON_IMAGES.length) {
                    images = CERREJON_IMAGES;
                    base = '../proyectos/industria/cerrejon/';
                } else if (proyectoId === 'mineros-bic' && typeof MINEROS_BIC_IMAGES !== 'undefined' && MINEROS_BIC_IMAGES.length) {
                    images = MINEROS_BIC_IMAGES;
                    base = '../proyectos/industria/minerosBic/';
                } else if (proyectoId === 'pepsico' && typeof PEPSICO_IMAGES !== 'undefined' && PEPSICO_IMAGES.length) {
                    images = PEPSICO_IMAGES;
                    base = '../proyectos/industria/pepsico/';
                } else if (proyectoId === 'spia' && typeof SPIA_IMAGES !== 'undefined' && SPIA_IMAGES.length) {
                    images = SPIA_IMAGES;
                    base = '../proyectos/industria/spia/';
                }
                return { images: images, base: base };
            }

            function buildPanelCarousel(proyectoId, titulo) {
                if (!panelCarouselTrack) return;
                panelCarouselTrack.innerHTML = '';
                panelCarouselImages = [];
                var data = getIndustryImagesAndBase(proyectoId);
                var images = data.images;
                var base = data.base;
                if (images.length === 0) return;
                panelCarouselImages = images.map(function(f) { return base + encodeURIComponent(f); });
                var wrap = panelCarouselTrack.closest('.proyecto-panel-carousel-wrap');
                if (wrap) wrap.classList.toggle('multiple', panelCarouselImages.length > 1);
                images.forEach(function(f, i) {
                    var slide = document.createElement('div');
                    slide.className = 'proyecto-panel-carousel-slide' + (i === 0 ? ' active' : '');
                    var img = document.createElement('img');
                    img.src = base + encodeURIComponent(f);
                    img.alt = titulo + ' - Imagen ' + (i + 1);
                    img.className = 'proyecto-panel-img';
                    slide.appendChild(img);
                    panelCarouselTrack.appendChild(slide);
                });
                panelCarouselIndex = 0;
            }

            function goPanelCarousel(delta) {
                if (panelCarouselImages.length <= 1) return;
                var slides = panelCarouselTrack ? panelCarouselTrack.querySelectorAll('.proyecto-panel-carousel-slide') : [];
                if (slides.length === 0) return;
                slides[panelCarouselIndex].classList.remove('active');
                panelCarouselIndex = (panelCarouselIndex + delta + slides.length) % slides.length;
                slides[panelCarouselIndex].classList.add('active');
            }

            function openProyectoPanel() {
                if (page) page.classList.add('proyecto-panel-open');
                document.body.classList.add('proyecto-panel-open');
                if (panel) panel.setAttribute('aria-hidden', 'false');
                if (backdrop) backdrop.setAttribute('aria-hidden', 'false');
            }
            function closeProyectoPanel() {
                if (page) page.classList.remove('proyecto-panel-open');
                document.body.classList.remove('proyecto-panel-open');
                if (panel) panel.setAttribute('aria-hidden', 'true');
                if (backdrop) backdrop.setAttribute('aria-hidden', 'true');
            }

            document.querySelectorAll('.proyecto-card').forEach(function(card) {
                var linkWrap = card.querySelector('.proyecto-card-link-wrap');
                if (!linkWrap) return;
                linkWrap.addEventListener('click', function(e) {
                    e.preventDefault();
                    var proyectoId = card.getAttribute('data-proyecto') || '';
                    var titulo = card.getAttribute('data-proyecto-titulo') || '';
                    var desc = card.getAttribute('data-proyecto-desc') || '';
                    var categoria = card.getAttribute('data-proyecto-categoria') || '';
                    var ano = card.getAttribute('data-proyecto-ano') || '';
                    var cliente = card.getAttribute('data-proyecto-cliente') || '';
                    buildPanelCarousel(proyectoId, titulo);
                    if (panelTitle) panelTitle.textContent = titulo;
                    if (panelCategoria) panelCategoria.textContent = categoria;
                    if (panelAno) panelAno.textContent = ano;
                    if (panelCliente) panelCliente.textContent = cliente;
                    if (panelDesc) panelDesc.textContent = desc;
                    openProyectoPanel();
                });
                linkWrap.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); linkWrap.click(); }
                });
            });

            if (panelCarouselPrev) panelCarouselPrev.addEventListener('click', function() { goPanelCarousel(-1); });
            if (panelCarouselNext) panelCarouselNext.addEventListener('click', function() { goPanelCarousel(1); });
            if (closeBtn) closeBtn.addEventListener('click', closeProyectoPanel);
            if (backdrop) backdrop.addEventListener('click', closeProyectoPanel);
        })();
    </script>
    <script>
        document.querySelectorAll('.nav-dropdown-toggle').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                var parent = this.closest('.nav-dropdown');
                var isOpen = parent.classList.contains('open');
                document.querySelectorAll('.nav-dropdown').forEach(function(d) { d.classList.remove('open'); });
                if (!isOpen) parent.classList.add('open');
                btn.setAttribute('aria-expanded', !isOpen);
            });
        });
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.nav-dropdown')) {
                document.querySelectorAll('.nav-dropdown').forEach(function(d) { d.classList.remove('open'); });
                document.querySelectorAll('.nav-dropdown-toggle').forEach(function(b) { b.setAttribute('aria-expanded', 'false'); });
            }
        });
    </script>
    <script src="../js/theme.js"></script>
</body>
</html>
